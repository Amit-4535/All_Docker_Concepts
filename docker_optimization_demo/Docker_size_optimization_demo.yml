

Docker image size optimization demo


docker images | grep imagename

this above command is used to check the image details such as ïƒ  name of image, image ID, when this was created and the size of the image..


Demo

starting with a heavy Ubuntu-based image, and step-by-step reducing it down using best practices.


Phase 1: Create the Base Directory
mkdir docker-optimize-demo
cd docker-optimize-demo


STEP 1: Basic Ubuntu Image (Unoptimized)
Vi Dockerfile.ubuntu

FROM ubuntu:22.04

RUN apt-get update
RUN apt-get install -y curl

CMD ["curl", "https://ipinfo.io/ip"]



Build & Check Size
docker build -f Dockerfile.ubuntu -t ubuntu-ipcheck .
docker images | grep ubuntu-ipcheck

Youâ€™ll see something around 100MB+



STEP 2: Combine RUN Commands + Cleanup APT
Vi Dockerfile.ubuntu-clean

FROM ubuntu:22.04

RUN apt-get update && apt-get install -y curl && \
    apt-get clean && rm -rf /var/lib/apt/lists/*

CMD ["curl", "https://ipinfo.io/ip"]


Build & Check Size
docker build -f Dockerfile.ubuntu-clean -t ubuntu-ipcheck-clean .
docker images | grep ubuntu-ipcheck-clean

Youâ€™ll see a size drop (~80â€“90 MB)



STEP 3: Use Alpine + .dockerignore (Tiny Image)

Vi Dockerfile.alpine

FROM alpine:latest

RUN apk --no-cache add curl

CMD ["curl", "https://ipinfo.io/ip"]


note --
.dockerignore (optional but good practice)
Add these below things in .dockerignore
*.log
*.sh~
.dockerignore
Dockerfile*




Build & Check Size
docker build -f Dockerfile.alpine -t alpine-ipcheck .
docker images | grep alpine-ipcheck

âœ… Youâ€™ll now see image size as ~5â€“6 MB ğŸ”¥



Compare all images ïƒ 
docker images | grep imagename



â“ Does using ubuntu, slim, or alpine change the functionality of the commands?
ğŸ”¹ Short Answer:
âœ… Yes and No â€” the functionality can remain the same if all dependencies are properly installed,
âŒ But the command syntax, available tools, and behavior can differ depending on the base image.



1. ubuntu Image
â€¢	Default shell: bash
â€¢	Package manager: apt-get
â€¢	Rich set of tools: curl, ping, bash, etc. (after installing)


  Example command:
RUN apt-get update && apt-get install -y curl


â¡ï¸ You get full compatibility for Linux commands and scripts â€” heavier, but more flexible.

ğŸ”¸ 2. ubuntu-slim or debian-slim
â€¢	Reduced base system â€” fewer preinstalled tools
â€¢	Same apt-get and bash
â€¢	May lack man pages, build tools, etc.
â€¢	Needs you to install more things manually
âœ… Functionality can be the same after installing whatâ€™s missing



ğŸ”¸ 3. alpine
â€¢	Default shell: sh (not bash)
â€¢	Package manager: apk (not apt)
â€¢	Musl-libc instead of glibc â†’ Some binaries may not work without compatibility packages
â€¢	Ultra minimal: Only core tools are there
â—ï¸ If your app or command depends on bash, glibc, or apt, you need to install them separately or they wonâ€™t work.



important --

Example comparison:
# Ubuntu
RUN apt-get update && apt-get install -y curl

# Alpine
RUN apk --no-cache add curl



ğŸ§  Key Differences that Affect Functionality
Aspect  	  Ubuntu/Debian	        Alpine
Shell	          bash	                sh (BusyBox shell)
Package Manager	  apt, dpkg	        apk
Binary Format	  glibc	                musl
File Locations	  /usr/bin, etc.  	Varies (may be symlinked)
Troubleshooting	  Easier (more tools)	Minimal (must install)


âœ… Final Answer: When Functionality Differs
Scenario	                                Functionality
You need Bash in Alpine (not installed)	        âŒ Wonâ€™t work without adding bash
You use apt in Alpine	                        âŒ Will fail, Alpine uses apk
You run curl in Alpine but itâ€™s missing	        âŒ Wonâ€™t work unless installed
Your app needs glibc (e.g., Java) in Alpine	âŒ May crash without glibc compat
Just printing IP via curl (installed)	        âœ… Works fine across all images



âœ… What You Should Do
Use Case	                Best Base Image
Lightweight curl/ping tasks	alpine
Full shell scripting/tools	ubuntu or debian
Production web builds	        Multi-stage w/ alpine final
Compatibility matters	        Stick to ubuntu




âœ… Example: Same Task â€” Slightly Different Commands
# Ubuntu
FROM ubuntu:22.04
RUN apt update && apt install -y bash curl
CMD ["bash", "-c", "curl https://ipinfo.io"]


# Alpine
FROM alpine
RUN apk add --no-cache bash curl
CMD ["bash", "-c", "curl https://ipinfo.io"]
âœ… Both work â€” if you account for tool difference








